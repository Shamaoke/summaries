<!DOCTYPE html>
<html lang='ru'>
<head>
<meta charset='utf-8'>
<link href='/summaries/stylesheet.css' rel='stylesheet'>
<title>CMake</title>
</head>
<body>
<header>
<h1>CMake</h1>
</header>
<main>
<h1 id="Содержание">Содержание</h1>

<p><a href="#Файлы">Файлы</a></p>

<p><a href="#Переменные_окружения">Переменные окружения</a></p>

<p><a href="#Переменные_CMake">Переменные CMake</a></p>

<p><a href="#Свойства_CMake">Свойства CMake</a></p>

<p><a href="#Перечень_команд_CMakeLists.txt">Перечень команд CMakeLists.txt</a></p>

<p><a href="#Перечень_команд_командной_строки">Перечень команд командной строки</a></p>

<p><a href="#Ссылки">Ссылки</a></p>

<p>В процессе разработки программного обеспечения наступает момент, когда
приходиться переводить исходный код во что-то, что может быть использовано
конечным пользователем.</p>

<p>Этот процесс называется <em>сборкой программного обеспечения</em>.</p>

<p>Сборка программного обеспечения — это комплексный процесс.</p>

<p>Для управления комплексностью при сборки программного обеспечения требуется подходящий инструмент.</p>

<p>Таким иструментом является CMake.</p>

<p><strong>CMake</strong> — инструмент <em>управления</em> сборкой программного обеспечения.</p>

<p>Цель CMake — обеспечить управляемостью комплексный процесс сборки программного обеспечения.</p>

<p>CMake представляет из себя набор инструментов для решения возложенных на него
задач.</p>

<p>Сборка программного обеспечения в системе CMake происходит поэтапно.</p>

<p>Упрощенно, процесс работы CMake можно разделить на пять этапов.</p>

<ul>
  <li>
    <p>Составление <em>файла описания проекта</em> (<em>файла управления сборкой</em>)</p>
  </li>
  <li>
    <p>Генерирование <em>файла сборки</em> из файла управления сборкой</p>

    <ul>
      <li>
        <p>Конфигурация</p>
      </li>
      <li>
        <p>Собственно генерирование</p>
      </li>
    </ul>
  </li>
  <li>
    <p>Сборка</p>
  </li>
  <li>
    <p>Тестирование</p>
  </li>
  <li>
    <p>Упаковка</p>
  </li>
</ul>

<p>Основным артефактом системы CMake является файл <code>CMakeLists.txt</code>. Он определяет
что должно быть собрано и как, какие тесты должны быть запущены и какие пакеты
созданы.</p>

<p>Данный файл является <em>файлом описания проекта</em>. Он служит для управления
комплексным процессом сборки программного обеспечения.</p>

<p>Фундаментальным понятием системы CMake является понятие <em>проекта</em>. Сборка
проекта — это то, что находится под управлением системы CMake.</p>

<p>Структура проекта состоит из двух частей: <em>исходные файлы</em> и <em>двоичные файлы</em>.</p>

<p>В рамках системы CMake установлен следующий порядок размещения указанных файлов
по каталогам: исходные файлы размещаются в <em>каталоге с исходным кодом</em>, двоичные
файлы размещаются в <em>каталоге с двоичными файлами</em> (или в <em>каталоге сборки</em>).</p>

<p>Каталог с исходным кодом находится под управлением разработчика.</p>

<p>Каталог сборки находится под управлением системы CMake. В процессе работы
системы в этом каталоге создаются различные артефакты системы сборки, а также файлы,
являющиеся результатом сборки.</p>

<p>В отношении того, где будет размещен каталог сборки существует два варианта.
Каталог сборки размещен в каталоге с исходным кодом (<em>in-source</em>). Каталог
сборки размещен вне каталога с исходным кодом (<em>out-source</em>).</p>

<p>В процессе работы система CMake создает файлы сборки выбранной системы сборки.
Для конкретной системы сборки должен быть использован соответствующий генератор.</p>

<p>Базовая форма работы с системой CMake.</p>

<pre><code>cd build&#x000A;cmake -G Ninja ../source&#x000A;cmake --build .&#x000A;</code></pre>

<p>Второй вариант базовой формы работы с системой CMake.</p>

<pre><code>cmake -G Ninja -S source -B build&#x000A;cmake --build build&#x000A;</code></pre>

<h1 id="Файлы">Файлы</h1>

<pre><code>/usr/bin/ccmake&#x000A;/usr/bin/cmake&#x000A;/usr/bin/cmake-gui&#x000A;/usr/bin/cpack&#x000A;/usr/bin/ctest&#x000A;&#x000A;/usr/share/man/man1/ccmake.1.gz&#x000A;/usr/share/man/man1/cmake-gui.1.gz&#x000A;/usr/share/man/man1/cmake.1.gz&#x000A;/usr/share/man/man1/cpack.1.gz&#x000A;/usr/share/man/man1/ctest.1.gz&#x000A;&#x000A;/usr/share/man/man7/cmake-buildsystem.7.gz&#x000A;/usr/share/man/man7/cmake-commands.7.gz&#x000A;/usr/share/man/man7/cmake-compile-features.7.gz&#x000A;/usr/share/man/man7/cmake-configure-log.7.gz&#x000A;/usr/share/man/man7/cmake-cxxmodules.7.gz&#x000A;/usr/share/man/man7/cmake-developer.7.gz&#x000A;/usr/share/man/man7/cmake-env-variables.7.gz&#x000A;/usr/share/man/man7/cmake-file-api.7.gz&#x000A;/usr/share/man/man7/cmake-generator-expressions.7.gz&#x000A;/usr/share/man/man7/cmake-generators.7.gz&#x000A;/usr/share/man/man7/cmake-language.7.gz&#x000A;/usr/share/man/man7/cmake-modules.7.gz&#x000A;/usr/share/man/man7/cmake-packages.7.gz&#x000A;/usr/share/man/man7/cmake-policies.7.gz&#x000A;/usr/share/man/man7/cmake-presets.7.gz&#x000A;/usr/share/man/man7/cmake-properties.7.gz&#x000A;/usr/share/man/man7/cmake-qt.7.gz&#x000A;/usr/share/man/man7/cmake-server.7.gz&#x000A;/usr/share/man/man7/cmake-toolchains.7.gz&#x000A;/usr/share/man/man7/cmake-variables.7.gz&#x000A;/usr/share/man/man7/cpack-generators.7.gz&#x000A;</code></pre>

<h1 id="Переменные_окружения">Переменные окружения</h1>

<dl>
  <dt><a href="https://cmake.org/cmake/help/latest/envvar/CMAKE_GENERATOR.html"><code>CMAKE_GENERATOR</code></a></dt>
  <dd>
    <p>Установить генератор, используемый системой по умолчанию</p>
  </dd>
</dl>

<h1 id="Переменные_CMake">Переменные CMake</h1>

<dl>
  <dt><a href="https://cmake.org/cmake/help/latest/variable/BUILD_SHARED_LIBS.html"><code>BUILD_SHARED_LIBS</code></a></dt>
  <dd>
    <p>Установить тип библиотек, собираемых по умолчанию</p>
  </dd>
  <dt><a href="https://cmake.org/cmake/help/latest/variable/CMAKE_COLOR_DIAGNOSTICS.html"><code>CMAKE_COLOR_DIAGNOSTICS</code></a></dt>
  <dd>
    <p>Включить цвета в диагностическом выводе</p>
  </dd>
  <dt><a href="https://cmake.org/cmake/help/latest/variable/CMAKE_LIBRARY_OUTPUT_DIRECTORY.html"><code>CMAKE_LIBRARY_OUTPUT_DIRECTORY</code></a></dt>
  <dd>
    <p>Установить каталог для размещения файлов библиотек</p>
  </dd>
  <dt><a href="https://cmake.org/cmake/help/latest/variable/CMAKE_RUNTIME_OUTPUT_DIRECTORY.html"><code>CMAKE_RUNTIME_OUTPUT_DIRECTORY</code></a></dt>
  <dd>
    <p>Установить каталог для размещения исполняемых файлов</p>
  </dd>
</dl>

<h1 id="Свойства_CMake">Свойства CMake</h1>

<dl>
  <dt><a href="https://cmake.org/cmake/help/latest/prop_tgt/RUNTIME_OUTPUT_NAME.html#prop_tgt:RUNTIME_OUTPUT_NAME"><code>RUNTIME_OUTPUT_NAME</code></a></dt>
  <dd>
    <p>Имя для целей, являющихся исполняемыми файлами</p>
  </dd>
</dl>

<h1 id="Перечень_команд_CMakeLists.txt">Перечень команд CMakeLists.txt</h1>

<dl>
  <dt><a href="https://cmake.org/cmake/help/latest/command/add_executable.html"><code>add_executable</code></a></dt>
  <dd>
    <p>Определить исполняемый файл целью сборки</p>
  </dd>
  <dt><code>add_executable(main first.cpp second.cpp)</code></dt>
  <dd>
    <p>Определить исполняемый файл целью сборки и установить исходники для неё</p>
  </dd>
</dl>

<p><code>add_executable(two EXCLUDE_FROM_ALL two.cpp)</code></p>

<ul>
  <li>
    <p>Определить исполняемый файл целью сборки</p>
  </li>
  <li>
    <p>Исключить данную цель из цели, выполняемой по умолчанию (<code>all</code>)</p>

    <p>Указанный исполняемый файл будет собран только в том случае, если он будет
являться зависимостью для другой цели или в случае явного указания цели в
командной строке (<code>cmake --build build --target two</code>).</p>
  </li>
</ul>

<dl>
  <dt><a href="https://cmake.org/cmake/help/latest/command/add_library.html"><code>add_library(targetName [STATIC | SHARED | MODULE] [EXCLUDE_FROM_ALL] source1 [source2 ...])</code></a></dt>
  <dd>
    <p>Определить библиотеку целью сборки</p>
  </dd>
</dl>

<p><a href="https://cmake.org/cmake/help/latest/command/cmake_minimum_required.html"><code>cmake_minimum_required(VERSION 3.29)</code></a></p>

<ul>
  <li>
    <p>Установить минимально допустимую версию системы CMake, используемую для
управления сборкой текущего проекта</p>
  </li>
  <li>
    <p>Установить поведение текущей версии CMake в соответствие с поведением
указанной версии системы</p>

    <p>В случае попытки сборки проекта системой CMake более ранней версии, возникнет
исключительная ситуация, которая приведет к останову процесса генерирования
файлов сборки.</p>

    <p>В случае, если текущая используемая версия системы CMake выше указанной,
функциональность текущей версии будет урезана до той, которая существует в
указанной.</p>

    <p>Следует выполнять данную команду в самом верху файла <code>CMakeLists.txt</code>.</p>

    <p>Устанавливает переменную <a href="https://cmake.org/cmake/help/latest/variable/CMAKE_MINIMUM_REQUIRED_VERSION.html"><code>CMAKE_MINIMUM_REQUIRED_VERSION</code></a>.</p>
  </li>
</ul>

<dl>
  <dt><a href="https://cmake.org/cmake/help/latest/command/include.html#command:include"><code>include(&lt;file|module&gt; [OPTIONAL] [RESULT_VARIABLE &lt;var&gt;] [NO_POLICY_SCOPE])</code></a></dt>
  <dd>
    <p>Загрузить и выполнить код CMake из указанного файла</p>
  </dd>
  <dt><a href="https://cmake.org/cmake/help/latest/command/message.html"><code>message("ok!")</code></a></dt>
  <dd>
    <p>Вывести указанное сообщение</p>
  </dd>
</dl>

<p><a href="https://cmake.org/cmake/help/latest/command/project.html"><code>project(sample LANGUAGES CXX)</code></a></p>

<ul>
  <li>
    <p>Установить имя проекта (<code>sample</code>)</p>
  </li>
  <li>
    <p>Установить используемые языки программирования (<code>CXX</code> — С++)</p>

    <p>В случае отсутствия компилятора для указанных языков, возникнет исключительная
ситуация, которая приведет к останову процесса генерирования файлов сборки.</p>

    <p>Следует выполнять данную команду сразу же после команды <code>cmake_minimum_required</code>.</p>

    <p>Устанавливает переменную <a href="https://cmake.org/cmake/help/latest/variable/PROJECT_NAME.html"><code>PROJECT_NAME</code></a>.</p>
  </li>
</ul>

<p><a href="https://cmake.org/cmake/help/latest/command/set.html"><code>set(&lt;variable&gt; [&lt;value&gt;...] [PARENT_SCOPE])</code></a></p>

<ul>
  <li>
    <p>Присвоить значение переменной, переменной кэша или переменной окружения в
случае, если параметр <code>&lt;value&gt;</code> передан</p>
  </li>
  <li>
    <p>Очистить значение переменной, переменной кэша или переменной окружения в
случае, если параметр <code>&lt;value&gt;</code> не передан</p>
  </li>
  <li>
    <p>Присвоить список значений переменной, переменной кэша или переменной окружения
в случае, если передано несколько параметров <code>&lt;value&gt;</code></p>
  </li>
</ul>

<dl>
  <dt><a href="https://cmake.org/cmake/help/latest/command/set.html"><code>set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ../bin)</code></a></dt>
  <dd>
    <p>Установить значение указанной переменной CMake</p>
  </dd>
  <dt><a href="https://cmake.org/cmake/help/latest/command/set_property.html"><code>set_property</code></a></dt>
  <dd>
    <p>Установить указанное свойство в заданных областях</p>
  </dd>
  <dt><code>set_property(TARGET one two PROPERTY EXCLUDE_FROM_ALL true)</code></dt>
  <dd>
    <p>Установить значение (<code>true</code>) для указанного свойства (<code>EXCLUDE_FROM_ALL</code>) для
заданных целей (<code>one</code>, <code>two</code>)</p>
  </dd>
  <dt><a href="https://cmake.org/cmake/help/latest/command/target_link_libraries.html"><code>target_link_libraries(targetName &lt;PRIVATE | PUBLIC | INTERFACE&gt; item1 [item2 ...] [&lt;PRIVATE | PUBLIC | INTERFACE&gt; item1 [item2 ...]])</code></a></dt>
  <dd>
    <p>Установить библиотеки, используемые в качестве зависимостей для указанной цели</p>
  </dd>
  <dt><a href="https://cmake.org/cmake/help/latest/command/unset.html"><code>unset(&lt;variable&gt; [CACHE | PARENT_SCOPE])</code></a></dt>
  <dd>
    <p>Очистить значение переменной, переменной кэша или переменной окружения</p>
  </dd>
</dl>

<h1 id="Перечень_команд_командной_строки">Перечень команд командной строки</h1>

<dl>
  <dt><code>cmake -G Ninja ..</code></dt>
  <dd>
    <p>Сгенерировать файлы сборки системы Ninja (<code>-G Ninja</code>) в текущем каталоге</p>
  </dd>
  <dd>
    <p>Файл сборки <code>CMakeLists.txt</code> должен находиться в родительском каталоге.</p>
  </dd>
  <dd>
    <p>Сгенерированные файлы будут находиться в текущем каталоге.</p>
  </dd>
  <dt><code>cmake --build .</code></dt>
  <dd>
    <p>Осуществить сборку проекта</p>
  </dd>
  <dd>
    <p>Сборка будет осуществлена из файлов, сгенерированных командой <code>cmake</code> в текущем каталоге.</p>
  </dd>
  <dt><code>cmake --build build --target one two</code></dt>
  <dd>
    <p>Осуществить сборку указанных целей</p>
  </dd>
  <dt><code>cmake -DBUILD_SHARED_LIBS=YES source</code></dt>
  <dd>
    <p>Установить значение указанной переменной CMake</p>
  </dd>
  <dt><code>cmake -D myVar:type=someValue ...</code></dt>
  <dd>
    <p>Установить значение указанной переменной кэша</p>
  </dd>
</dl>

<h1 id="Ссылки">Ссылки</h1>

<ul>
  <li>
    <p><a href="https://gitlab.kitware.com/cmake/community/-/wikis/FAQ">FAQ · Wiki · CMake / Community · GitLab</a></p>
  </li>
  <li>
    <p><a href="https://cmake.org/cmake/help/latest">CMake Reference Documentation — CMake 3.29.0 Documentation</a></p>
  </li>
  <li>
    <p><a href="https://cmake.org/cmake/help/latest/guide/using-dependencies/index.html">Using Dependencies Guide — CMake 3.29.0 Documentation</a></p>
  </li>
  <li>
    <p><a href="https://discourse.cmake.org">CMake Discourse</a></p>
  </li>
  <li>
    <p><a href="https://cmake.org/cmake/help/latest/manual/cmake-commands.7.html">cmake-commands(7) — CMake 3.29.0 Documentation</a></p>
  </li>
  <li>
    <p><a href="https://cmake.org/cmake/help/latest/manual/cmake-env-variables.7.html#manual:cmake-env-variables(7)">cmake-env-variables(7) — CMake 3.29.0 Documentation</a></p>
  </li>
  <li>
    <p><a href="https://cmake.org/cmake/help/latest/manual/cmake-variables.7.html">cmake-variables(7) — CMake 3.29.0 Documentation</a></p>
  </li>
  <li>
    <p><a href="https://cmake.org/cmake/help/latest/manual/cmake-properties.7.html">cmake-properties(7) — CMake 3.29.0 Documentation</a></p>
  </li>
</ul>

<!-- vim: set textwidth=80 colorcolumn=80: -->

</main>
<footer></footer>
</body>
</html>
